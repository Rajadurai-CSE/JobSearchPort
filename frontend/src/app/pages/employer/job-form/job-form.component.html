<app-navbar></app-navbar>

<div class="page-container">
    <div class="page-header">
        <h1>{{ isEditMode ? 'Edit Job' : 'Post New Job' }}</h1>
        <p>{{ isEditMode ? 'Update vacancies and deadline for your job posting' : 'Create a new job listing' }}</p>
    </div>

    <!-- Toast -->
    <div *ngIf="message" class="toast" [ngClass]="messageType === 'success' ? 'alert-success' : 'alert-danger'">
        {{ message }}
    </div>

    <!-- Loading -->
    <div *ngIf="loading" class="loading">
        <div class="spinner"></div>
    </div>

    <div *ngIf="!loading" class="form-card">
        <!-- Edit mode notice -->
        <div *ngIf="isEditMode" class="alert alert-info"
            style="margin-bottom: 1rem; padding: 1rem; background: rgba(78, 205, 196, 0.15); border-radius: var(--radius-md);">
            ⚠️ In edit mode, only <strong>Number of Vacancies</strong> and <strong>Application Deadline</strong> can be
            updated.
        </div>

        <!-- Creation mode notice -->
        <div *ngIf="!isEditMode" class="alert alert-warning"
            style="margin-bottom: 1rem; padding: 1rem; background: rgba(255, 193, 7, 0.15); border-radius: var(--radius-md); border: 1px solid rgba(255, 193, 7, 0.2);">
            ⚠️ <strong>Important:</strong> Once created, you will only be able to update the <strong>Number of
                Vacancies</strong> and <strong>Application Deadline</strong>. Other details cannot be changed.
        </div>

        <form (ngSubmit)="onSubmit()">
            <div class="form-group">
                <label class="form-label">Job Title *</label>
                <input type="text" class="form-control" [(ngModel)]="formData.title" name="title" required
                    placeholder="e.g., Senior Frontend Developer" [disabled]="isEditMode">
            </div>

            <div class="form-group">
                <label class="form-label">Description *</label>
                <textarea class="form-control" [(ngModel)]="formData.description" name="description" rows="5" required
                    placeholder="Describe the role and responsibilities..." [disabled]="isEditMode"></textarea>
            </div>

            <div class="grid-2">
                <div class="form-group">
                    <label class="form-label">Location *</label>
                    <input type="text" class="form-control" [(ngModel)]="formData.location" name="location" required
                        placeholder="e.g., New York, NY" [disabled]="isEditMode">
                </div>
                <div class="form-group">
                    <label class="form-label">Employment Type</label>
                    <select class="form-control form-select" [(ngModel)]="formData.employmentType" name="employmentType"
                        [disabled]="isEditMode">
                        <option value="FULL_TIME">Full-time</option>
                        <option value="PART_TIME">Part-time</option>
                        <option value="CONTRACT">Contract</option>
                        <option value="INTERNSHIP">Internship</option>
                        <option value="REMOTE">Remote</option>
                    </select>
                </div>
            </div>

            <div class="grid-2">
                <div class="form-group">
                    <label class="form-label">Salary Range</label>
                    <input type="text" class="form-control" [(ngModel)]="formData.salaryRange" name="salaryRange"
                        placeholder="e.g., $80,000 - $100,000" [disabled]="isEditMode">
                </div>
                <div class="form-group">
                    <label class="form-label">Application Deadline *</label>
                    <input type="date" class="form-control" [(ngModel)]="formData.applicationDeadline"
                        name="applicationDeadline" required>
                </div>
            </div>

            <div class="grid-2">
                <div class="form-group">
                    <label class="form-label">Min. Experience (years)</label>
                    <input type="number" class="form-control" [(ngModel)]="formData.minimumExperience"
                        name="minimumExperience" min="0" [disabled]="isEditMode">
                </div>
                <div class="form-group">
                    <label class="form-label">No. of Vacancies</label>
                    <input type="number" class="form-control" [(ngModel)]="formData.noOfVacancies" name="noOfVacancies"
                        min="1">
                </div>
            </div>

            <div class="form-group">
                <label class="form-label">Required Skills *</label>
                <input type="text" class="form-control" [(ngModel)]="formData.requiredSkills" name="requiredSkills"
                    required placeholder="e.g., JavaScript, React, TypeScript" [disabled]="isEditMode">
            </div>

            <div class="form-actions">
                <a routerLink="/employer/jobs" class="btn btn-outline">Cancel</a>
                <button type="submit" class="btn btn-primary" [disabled]="saving">
                    {{ saving ? 'Saving...' : (isEditMode ? 'Update Job' : 'Post Job') }}
                </button>
            </div>
        </form>
    </div>
</div>